---
name: gtm
description: GTM(Google Tag Manager) ì»¨í…Œì´ë„ˆ ê´€ë¦¬ ì—ì´ì „íŠ¸. GTM ë¶„ì„, ì´ë²¤íŠ¸ ì¶”ê°€, ì„¤ì • ê²€ì¦, ë””ë²„ê¹…, ë‚´ë³´ë‚´ê¸°, ë‹¤ì¤‘ ì»¨í…Œì´ë„ˆ ì¼ê´„ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. GTM, íƒœê·¸, íŠ¸ë¦¬ê±°, ë³€ìˆ˜, GA4, ì´ì»¤ë¨¸ìŠ¤, ë°ì´í„°ë ˆì´ì–´ ê´€ë ¨ ì‘ì—…ì— ì‚¬ìš©í•©ë‹ˆë‹¤.
---

# GTM Agent

GTM ì»¨í…Œì´ë„ˆ ê´€ë¦¬ë¥¼ ìœ„í•œ í†µí•© skillì…ë‹ˆë‹¤.

## Core Principle

**GTMì´ ìœ ì¼í•œ ì§„ì‹¤ì˜ ì›ì²œì…ë‹ˆë‹¤.**
- í•­ìƒ GTMì„ ë¨¼ì € íŒŒì‹±í•˜ì—¬ íŒ¨í„´ ì¶”ì¶œ
- ì™¸ë¶€ ë¬¸ì„œëŠ” íŒŒë¼ë¯¸í„° í‚¤ì—ë§Œ ì‚¬ìš©
- ë„¤ì´ë° ì»¨ë²¤ì…˜ì€ ì˜¤ì§ GTMì—ì„œ ê°ì§€

## Operations

| ì‘ì—… | ì„¤ëª… |
|------|------|
| **analyze** | ì»¨í…Œì´ë„ˆ ë¶„ì„, íŒ¨í„´ ì¶”ì¶œ |
| **add** | ì´ë²¤íŠ¸ ì¶”ê°€ (íƒœê·¸+íŠ¸ë¦¬ê±°+ë³€ìˆ˜) |
| **validate** | ì„¤ì • ê²€ì¦ (ë„¤ì´ë°, ì°¸ì¡°, ë¯¸ì‚¬ìš©) |
| **debug** | ì´ë²¤íŠ¸ ë¯¸ìˆ˜ì§‘ ì›ì¸ ë¶„ì„ |
| **export** | JSON, ìŠ¤í™, ì²´í¬ë¦¬ìŠ¤íŠ¸ ë‚´ë³´ë‚´ê¸° |
| **bulk** | ë‹¤ì¤‘ ì»¨í…Œì´ë„ˆ ì¼ê´„ ì‘ì—… |

## Add Workflow (í•µì‹¬)

```
âš ï¸ êµ¬í˜„ ì „ ë°˜ë“œì‹œ ì‚¬ìš©ìì™€ í•¨ê»˜ ë…¼ì˜

1. ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸ (í•„ìˆ˜!)
   â†’ "ì´ ì´ë²¤íŠ¸ëŠ” ì–´ë””ì„œ ë°œë™ë˜ë‚˜ìš”?"
   â†’ "ì›¹ì—ì„œ dataLayer.pushë¡œ ë°œìƒ? GTMì—ì„œ ì¡°ê±´ ì„¤ì • í•„ìš”?"
   â†’ "ì–´ë–¤ ì¡°ê±´ì—ì„œ ë°œë™ë˜ì–´ì•¼ í•˜ë‚˜ìš”?"

2. ì´ë²¤íŠ¸ ìœ í˜• í•¨ê»˜ ê²°ì •
   â†’ Type A: ì›¹ dataLayer.push â†’ ë‹¨ìˆœ CE íŠ¸ë¦¬ê±°
   â†’ Type B: GTM ë‚´ë¶€ ë¡œì§ â†’ í•¨ê»˜ ì¡°ê±´/ë¡œì§ ì„¤ê³„
   â†’ Type C: ì›¹ + GTM í•„í„° â†’ í•„í„° ì¡°ê±´ í˜‘ì˜

3. Type Bì¸ ê²½ìš° ìƒì„¸ í˜‘ì˜
   â†’ ë°œë™ ì¡°ê±´: DOM Ready? í´ë¦­? íƒ€ì´ë¨¸?
   â†’ ì¤‘ë³µ ë°©ì§€: ì„¸ì…˜ë‹¹ 1íšŒ? í˜ì´ì§€ë‹¹ 1íšŒ?
   â†’ í•„ìš” ë°ì´í„°: ì¿ í‚¤? ì„¸ì…˜ID? í˜ì´ì§€ ì •ë³´?

4. êµ¬í˜„ ë°©í–¥ í•©ì˜ í›„ ì§„í–‰
   â†’ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì„ íƒ
   â†’ ì¤‘ë³µ ì²´í¬
   â†’ ìƒì„± ìˆœì„œ: ë³€ìˆ˜ â†’ íŠ¸ë¦¬ê±° â†’ íƒœê·¸
```

## Self-Check

Add ì‘ì—… ì „ (í•„ìˆ˜):
- [ ] ì‚¬ìš©ìì—ê²Œ ì´ë²¤íŠ¸ ë°œë™ ë°©ì‹ ì§ˆë¬¸í–ˆë‚˜?
- [ ] ì´ë²¤íŠ¸ ìœ í˜•(A/B/C) í•¨ê»˜ ê²°ì •í–ˆë‚˜?
- [ ] Type Bë©´ ì¡°ê±´/ë¡œì§ í•¨ê»˜ ì„¤ê³„í–ˆë‚˜?
- [ ] ì¤‘ë³µ ì²´í¬ ì‹¤í–‰í–ˆë‚˜?
- [ ] íŒŒë¼ë¯¸í„° í‚¤ ë„¤ì´ë° íŒ¨í„´ í™•ì¸í–ˆë‚˜? (snake_case vs camelCase)
- [ ] **ì™¸ë¶€ ì‹ë³„ì ìƒì„± ì‹œ prefix íŒ¨í„´ ê°ì§€í–ˆë‚˜?** (window, cookie, localStorage, ì „ì—­í•¨ìˆ˜ ë“±)
- [ ] ì‚¬ìš©ì ìŠ¹ì¸ í›„ ì§„í–‰í•˜ëŠ”ê°€?

## Resources

```
resources/
â”œâ”€â”€ procedures.md                # ìƒì„¸ ì›Œí¬í”Œë¡œìš°
â””â”€â”€ references/
    â”œâ”€â”€ workspace.md             # ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ê´€ë¦¬
    â”œâ”€â”€ event-types.md           # ì´ë²¤íŠ¸ ìœ í˜• ë¶„ë¥˜
    â”œâ”€â”€ duplicate-check.md       # 3-Layer ì¤‘ë³µ ì²´í¬
    â”œâ”€â”€ validation.md            # Pre-Add ê²€ì¦, ES5 ì½”ë“œ í‘œì¤€
    â”œâ”€â”€ safety-rules-test.md     # MCP ì•ˆì „ ê·œì¹™ TDD ëª…ì„¸
    â”œâ”€â”€ patterns.md              # íŒ¨í„´ ë¬¸ì„œ ì¸ë±ìŠ¤
    â”‚   â”œâ”€â”€ naming-conventions.md    # GA4 ë„¤ì´ë°, ì¼€ì´ìŠ¤ ë³€í™˜
    â”‚   â”œâ”€â”€ pattern-detection.md     # íŒ¨í„´ ê°ì§€ ì•Œê³ ë¦¬ì¦˜
    â”‚   â”œâ”€â”€ parameter-keys.md        # íŒŒë¼ë¯¸í„° í‚¤ íŒ¨í„´
    â”‚   â””â”€â”€ external-identifiers.md  # ì™¸ë¶€ ì‹ë³„ì prefix
```

## Examples

- "GTM ì»¨í…Œì´ë„ˆ ë¶„ì„í•´ì¤˜" â†’ analyze ì‹¤í–‰
- "view_item ì´ë²¤íŠ¸ ì¶”ê°€í•´ì¤˜" â†’ ë¨¼ì € ë°œë™ ë°©ì‹ ì§ˆë¬¸ í›„ add workflow
- "í˜„ì¬ ì„¤ì • ê²€ì¦í•´ì¤˜" â†’ validate ì‹¤í–‰
- "purchase ì´ë²¤íŠ¸ê°€ ìˆ˜ì§‘ ì•ˆë¼" â†’ debug ì‹¤í–‰

## Guidelines

- **ì´ë²¤íŠ¸ ì¶”ê°€ ìš”ì²­ ì‹œ ë¨¼ì € ì§ˆë¬¸í•˜ê¸°** - ë°”ë¡œ êµ¬í˜„í•˜ì§€ ì•ŠìŒ
- êµ¬í˜„ ë°©í–¥ì„ ì‚¬ìš©ìì™€ í•¨ê»˜ ê²°ì •
- ì¤‘ë³µ ì²´í¬ ì—†ì´ íŠ¸ë¦¬ê±°/íƒœê·¸ ìƒì„± ê¸ˆì§€
- ì‚¬ìš©ì ìŠ¹ì¸ ì—†ì´ ìƒì„± ì‘ì—… ì§„í–‰ ê¸ˆì§€

## MCP Safety Rules (í•„ìˆ˜ - TDD ê²€ì¦ ì™„ë£Œ)

### ğŸš¨ CRITICAL: ì ˆëŒ€ í˜¸ì¶œ ê¸ˆì§€ MCP Actions

**TDD í…ŒìŠ¤íŠ¸ ê²°ê³¼ (2024-12-28): MCP ì„œë²„ëŠ” ì°¨ë‹¨ ê¸°ëŠ¥ì´ ì—†ìŒ. ì—ì´ì „íŠ¸ê°€ ë°˜ë“œì‹œ ì¤€ìˆ˜í•´ì•¼ í•¨.**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â›” NEVER CALL - ì•„ë˜ MCP ì•¡ì…˜ì€ ì–´ë–¤ ìƒí™©ì—ì„œë„ í˜¸ì¶œ ê¸ˆì§€          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  1. gtm_workspace(action: "remove", ...)                           â”‚
â”‚     â†’ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì‚­ì œ - GTM UIì—ì„œë§Œ ìˆ˜í–‰                         â”‚
â”‚                                                                     â”‚
â”‚  2. gtm_container(action: "remove", ...)                           â”‚
â”‚     â†’ ì»¨í…Œì´ë„ˆ ì‚­ì œ - GTM UIì—ì„œë§Œ ìˆ˜í–‰                             â”‚
â”‚                                                                     â”‚
â”‚  3. gtm_version(action: "publish", ...)                            â”‚
â”‚     â†’ ë²„ì „ ë°°í¬ - GTM UIì—ì„œë§Œ ìˆ˜í–‰                                 â”‚
â”‚                                                                     â”‚
â”‚  4. gtm_account - ì‚­ì œ ì•¡ì…˜                                         â”‚
â”‚     â†’ API ë¯¸ì§€ì› (get, list, updateë§Œ ê°€ëŠ¥)                        â”‚
â”‚                                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš ï¸  ì‚¬ìš©ìê°€ ìš”ì²­í•´ë„ ê±°ë¶€í•˜ê³  GTM UI ì•ˆë‚´                         â”‚
â”‚     URL: https://tagmanager.google.com/                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ìš”ì²­ ì‹œ ì‘ë‹µ í…œí”Œë¦¿

```
ì‚¬ìš©ì: "ì›Œí¬ìŠ¤í˜ì´ìŠ¤/ì»¨í…Œì´ë„ˆ ì‚­ì œí•´ì¤˜" ë˜ëŠ” "ë²„ì „ ë°°í¬í•´ì¤˜"

ì‘ë‹µ:
"í•´ë‹¹ ì‘ì—…ì€ MCPë¥¼ í†µí•´ ìˆ˜í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

ğŸ”’ ë³´ì•ˆ ì •ì±…ì— ë”°ë¼ ì•„ë˜ ì‘ì—…ì€ GTM UIì—ì„œë§Œ ìˆ˜í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤:
- ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì‚­ì œ
- ì»¨í…Œì´ë„ˆ ì‚­ì œ
- ë²„ì „ ë°°í¬ (Publish)

ğŸ‘‰ GTM UI: https://tagmanager.google.com/
   ê²½ë¡œ: [í•´ë‹¹ ë¦¬ì†ŒìŠ¤] â†’ ì‚­ì œ/ê²Œì‹œ ë²„íŠ¼"
```

### MCP í—ˆìš© ë²”ìœ„

| Action | í—ˆìš© | ì¡°ê±´ |
|--------|------|------|
| list, get | âœ… | ì œí•œ ì—†ìŒ |
| create | âœ… | ì‚¬ìš©ì ìŠ¹ì¸ í›„ |
| update | âœ… | ì‚¬ìš©ì ìŠ¹ì¸ í›„ |
| createVersion | âœ… | ë°°í¬ ì „ ê²€í† ìš© |
| remove (tag/trigger/variable) | âœ… | ì‚¬ìš©ì ìŠ¹ì¸ í›„ |
| **remove (workspace/container)** | âŒ | **GTM UI ì „ìš©** |
| **publish** | âŒ | **GTM UI ì „ìš©** |

## Code Standards

**âš ï¸ GTMì€ ECMAScript 5 (ES5) ê¸°ì¤€ìœ¼ë¡œ ì½”ë“œ ì‘ì„± í•„ìˆ˜**

Custom HTML, Custom JavaScript ë³€ìˆ˜ ì‘ì„± ì‹œ:
```
âŒ ì‚¬ìš© ê¸ˆì§€ (ES6+)          âœ… ì‚¬ìš© í•„ìˆ˜ (ES5)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const, let               â†’  var
() => {}                 â†’  function() {}
`template ${var}`        â†’  'string ' + var
{ a, b } = obj           â†’  var a = obj.a
[...arr]                 â†’  arr.slice()
class MyClass {}         â†’  function MyClass() {}
async/await              â†’  callback íŒ¨í„´
```

**âš ï¸ Custom HTML íƒœê·¸ëŠ” ë°˜ë“œì‹œ try-catchë¡œ ê°ì‹¸ê¸°**

```html
<script>
  try {
    // ì‹¤ì œ ë¡œì§
  } catch (e) {
    // ì˜¤ë¥˜ ë°œìƒí•´ë„ ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ ê³„ì† ì‹¤í–‰
  }
</script>
```

## GA4 Naming Standards

**âš ï¸ GA4ëŠ” ì´ë²¤íŠ¸ëª…ê³¼ íŒŒë¼ë¯¸í„° í‚¤ì— snake_case ê¶Œì¥**

```
âŒ ìš”ì²­ (camelCase)           âœ… ë³€í™˜ (snake_case)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
startCamera              â†’  start_camera
viewProduct              â†’  view_product
pageType                 â†’  page_type
itemId                   â†’  item_id
```

- camelCase ìš”ì²­ ì‹œ snake_caseë¡œ ë³€í™˜ í›„ ì‚¬ìš©ìì—ê²Œ ì•ˆë‚´
- ê¸°ì¡´ ì»¨í…Œì´ë„ˆ íŒ¨í„´ê³¼ ì¼ì¹˜ ì—¬ë¶€ í™•ì¸ í•„ìˆ˜
- ìƒì„¸: [naming-conventions.md](resources/references/naming-conventions.md)

## External Identifier Prefix

**âš ï¸ GTMì´ ê´€ë¦¬í•˜ëŠ” ì™¸ë¶€ ì‹ë³„ì ìƒì„± ì‹œ ë°˜ë“œì‹œ prefix í™•ì¸**

ì›¹ì‚¬ì´íŠ¸ì™€ ì¶©ëŒ ê°€ëŠ¥í•œ ëª¨ë“  ì™¸ë¶€ ì‹ë³„ì:
| ìœ í˜• | ì˜ˆì‹œ | ì¶©ëŒ ìœ„í—˜ |
|------|------|----------|
| window ì†ì„± | `window.bdp_flag` | ë†’ìŒ |
| Cookie | `bdp_sessionId` | ë†’ìŒ |
| localStorage | `bdp_userPrefs` | ì¤‘ê°„ |
| sessionStorage | `bdp_tempData` | ì¤‘ê°„ |
| ì „ì—­ í•¨ìˆ˜ | `function bdp_trackEvent()` | ë†’ìŒ |

```
ì›Œí¬í”Œë¡œìš°:
1. ê¸°ì¡´ ì»¨í…Œì´ë„ˆì—ì„œ prefix íŒ¨í„´ ê°ì§€
   â†’ ì¿ í‚¤ ë³€ìˆ˜: bdp_multiHost_eventFired â†’ "bdp_"
   â†’ window ë³€ìˆ˜: window.bdp_xxx â†’ "bdp_"
   â†’ localStorage: bdp_userPrefs â†’ "bdp_"

2. ê°ì§€ëœ prefixë¡œ ì‚¬ìš©ì í™•ì¸
   â†’ "ê¸°ì¡´ íŒ¨í„´ 'bdp_'ë¥¼ ì‚¬ìš©í• ê¹Œìš”?"

3. ë¯¸ê°ì§€ ì‹œ ìƒˆ prefix ìš”ì²­
   â†’ "íŒ€/í”„ë¡œì íŠ¸ prefixë¥¼ ì§€ì •í•´ì£¼ì„¸ìš” (ì˜ˆ: bdp_, mkt_)"
```

```
âŒ ì˜ëª»ëœ ì˜ˆ                    âœ… ì˜¬ë°”ë¥¸ ì˜ˆ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window._contentLoaded      â†’  window.bdp_contentLoaded
_mySessionCookie           â†’  bdp_mySessionCookie
localStorage.tempData      â†’  localStorage.bdp_tempData
function trackEvent()      â†’  function bdp_trackEvent()
```

- ì¶©ëŒ ë°©ì§€ ë° ë””ë²„ê¹… ìš©ì´ì„±ì„ ìœ„í•´ í•„ìˆ˜
- ìƒì„¸: [external-identifiers.md](resources/references/external-identifiers.md)
